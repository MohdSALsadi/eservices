@{
    Layout = null;
}
<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="rtl">
<!-- BEGIN: Head-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Modern admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities with bitcoin dashboard.">
    <meta name="keywords" content="admin template, modern admin template, dashboard template, flat admin template, responsive admin template, web app, crypto dashboard, bitcoin dashboard">
    <meta name="author" content="PIXINVENT">
    <title>Register Page - صفحة التسجيل</title>
    <link rel="apple-touch-icon" href="../../../app-assets/images/ico/apple-icon-120.png">
    <link rel="shortcut icon" type="image/x-icon" href="../../../app-assets/images/ico/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i%7CQuicksand:300,400,500,700" rel="stylesheet">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="~/vendors/css/vendors-rtl.min.css">

    <link rel="stylesheet" type="text/css" href="~/css/rtl/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="~/css/rtl/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="~/css/rtl/colors.css">
    <link rel="stylesheet" type="text/css" href="~/css/rtl/components.css">
    <link rel="stylesheet" type="text/css" href="~/css/rtl/custom-rtl.css">

    <link rel="stylesheet" type="text/css" href="~/css/rtl/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="~/css/rtl/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="~/css/rtl/pages/login-register.css">

    <link href="~/css/style-rtl.css" rel="stylesheet" />
    <script src="~/js/configuration.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>


    <style>
        .error-message {
            color: red;
            text-align: left;
            float: left;
        }

        body {
            font-family: 'Quicksand';
        }

        .card-subtitle {
            font-family: 'Quicksand';
        }
    </style>
</head>


<body class="vertical-layout vertical-menu 1-column   blank-page" data-open="click" data-menu="vertical-menu" data-col="1-column">
    <div class="app-content content">
        <div class="content-overlay"></div>
        <div class="content-wrapper">
            <div class="content-header row">
            </div>
            <div class="content-body">
                <section class="row flexbox-container">
                    <div class="col-12 d-flex align-items-center justify-content-center">
                        <div class="col-lg-4 col-md-8 col-10 box-shadow-2 p-0">
                            <div class="card border-grey border-lighten-3 px-2 py-2 m-0">
                                <div class="card-header border-0">
                                    <div class="card-title text-center">
                                        <img src="~/images/logo/LogoRno.png" alt="branding logo" style="width:30%;height:30%;">
                                    </div>
                                    <h6 class="card-subtitle line-on-side text-muted text-center font-small-3 pt-2">
                                        <span>Register Account - تسجيل مستخدم جديد</span>
                                    </h6>
                                </div>
                                <div class="card-content">
                                    <div class="card-body">
                                        <form asp-action="Register" method="post" class="form-horizontal form-simple" id="registration-form" dir="ltr">

                                            <fieldset class="form-group position-relative has-icon-right mb-1">
                                                <input name="Username" type="text" class="form-control form-control-lg input-lg" id="user-name" placeholder="Username - أسم المستخدم" autocomplete="off">
                                                <div class="form-control-position">
                                                    <i class="la la-user"></i>
                                                </div>
                                                <span class="error-message" id="user-name-error"></span>
                                            </fieldset>
                                            <fieldset class="form-group position-relative has-icon-right mb-1">
                                                <input type="text" name="Name" class="form-control form-control-lg input-lg" id="name" placeholder="Full Name - الأسم الكامل" autocomplete="off">
                                                <div class="form-control-position">
                                                    <i class="la la-user"></i>
                                                </div>
                                                <span class="error-message" id="name-error"></span>
                                            </fieldset>

                                            <fieldset class="form-group position-relative has-icon-right mb-1">
                                                <input type="email" name="Email" class="form-control form-control-lg input-lg" id="user-email" placeholder="Email - البريد الإلكتروني" autocomplete="off">
                                                <div class="form-control-position">
                                                    <i class="la la-envelope"></i>
                                                </div>
                                                <span class="error-message" id="user-email-error"></span>
                                            </fieldset>
                                            <fieldset class="form-group position-relative has-icon-right">
                                                <input name="Password" type="password" class="form-control form-control-lg input-lg" id="user-password" placeholder="Password - كلمة السر" autocomplete="off">
                                                <div class="form-control-position">
                                                    <i class="la la-key"></i>
                                                </div>
                                                <span class="error-message" id="user-password-error"></span>
                                            </fieldset>
                                            <fieldset class="form-group position-relative has-icon-right">
                                                <input type="password" class="form-control form-control-lg input-lg" id="confirm-user-password" placeholder="Confirm Password - تأكيد كلمة السر" autocomplete="off">
                                                <div class="form-control-position">
                                                    <i class="la la-key"></i>
                                                </div>
                                                <span class="error-message" id="confirm-user-password-error"></span>
                                            </fieldset>

                                            <fieldset class="form-group position-relative has-icon-right">
                                                <input name="ContactNumber" type="text" class="form-control form-control-lg input-lg" id="contactnumber" placeholder="Office Number - رقم هاتف المكتب" autocomplete="off">
                                                <div class="form-control-position">
                                                    <i class="la la-mobile"></i>
                                                </div>
                                                <span class="error-message" id="contactnumber-error"></span>
                                            </fieldset>

                                            <span id="general-error" class="error-message"></span>
                                            <button type="submit" class="btn btn-success btn-lg btn-block">Register</button>
                                        </form>
                                    </div>
                                    <p class="text-center">Already have an account? <a href="@Url.Action("login","account")" class="card-link">Login </a></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('registration-form').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent form submission

            // Clear existing error messages
            var errorMessages = document.querySelectorAll('.error-message');
            errorMessages.forEach(function (element) {
                element.textContent = '';
            });

            // Form field values
            var userName = document.getElementById('user-name').value;
            var name = document.getElementById('name').value;
            var email = document.getElementById('user-email').value;
            var password = document.getElementById('user-password').value;
            var confirmPassword = document.getElementById('confirm-user-password').value;
            var contactNumber = document.getElementById('contactnumber').value;


            var isValid = true;

            // Check if any required field is empty
            if (!userName || !name || !email || !password || !confirmPassword || !contactNumber) {
                isValid = false;
                document.getElementById('general-error').textContent = 'Please fill in all fields.';
                return;
            }

            // Check username
            if (!/^[a-zA-Z]+$/.test(userName)) {
                isValid = false;
                document.getElementById('user-name-error').textContent = 'Username must contain only English letters.';
            }




            if (!isValidEmail(email)) {
                isValid = false;
                document.getElementById('user-email-error').textContent = 'Invalid email format.';
            }

            // Check password
            if (password.length < 5 || !/\d/.test(password) || !/[a-zA-Z]/.test(password)) {
                isValid = false;
                document.getElementById('user-password-error').textContent = 'Password must be at least 5 characters long and contain letters and numbers.';
            }

            // Check if passwords match
            if (password !== confirmPassword) {
                isValid = false;
                document.getElementById('confirm-user-password-error').textContent = 'Passwords do not match.';
            }

            // Check contact number
            if (!/^\d{8}$/.test(contactNumber)) {
                isValid = false;
                document.getElementById('contactnumber-error').textContent = 'Contact number must be 8 digits long.';
            }

            if (isValid) {
                // Check if email already exists
                $.post('/Account/CheckEmailExist', { email: email }, function (data) {
                    if (data) {
                        isValid = false;
                        document.getElementById('user-email-error').textContent = 'Email is already registered.';
                    } else {
                        // If email is valid, check if username already exists
                        $.post('/Account/CheckUsernameExist', { username: userName }, function (data) {
                            if (data) {
                                isValid = false;
                                document.getElementById('user-name-error').textContent = 'Username is already taken.';
                            } else {
                                // If form is valid, submit it
                                document.getElementById('registration-form').submit();
                            }
                        });
                    }
                }).fail(function () {
                    isValid = false;
                    document.getElementById('general-error').textContent = 'Error verifying email.';
                });
            }
        });
    </script>

</body>

</html>
